/*! jquery-textcomplete - v1.6.2 - 2016-09-01 */
(function(a){if(typeof define==="function"&&define.amd){define(["jquery"],a)}else{if(typeof module==="object"&&module.exports){var b=require("jquery");module.exports=a(b)}else{a(jQuery)}}}(function(a){if(typeof a==="undefined"){throw new Error("jQuery.textcomplete requires jQuery")}+function(b){var d=function(e){if(console.warn){console.warn(e)}};var c=1;b.fn.textcomplete=function(g,f){var e=Array.prototype.slice.call(arguments);return this.each(function(){var i=this;var j=b(this);var h=j.data("textComplete");if(!h){f||(f={});f._oid=c++;h=new b.fn.textcomplete.Completer(this,f);j.data("textComplete",h)}if(typeof g==="string"){if(!h){return}e.shift();h[g].apply(h,e);if(g==="destroy"){j.removeData("textComplete")}}else{b.each(g,function(k){b.each(["header","footer","placement","maxCount"],function(l){if(k[l]){h.option[l]=k[l];d(l+"as a strategy param is deprecated. Use option.");delete k[l]}})});h.register(b.fn.textcomplete.Strategy.parse(g,{el:i,$el:j}))}})}}(a);+function(e){var d=function(i){var h,g;return function(){var k=Array.prototype.slice.call(arguments);if(h){g=k;return}h=true;var j=this;k.unshift(function l(){if(g){var m=g;g=undefined;m.unshift(l);i.apply(j,m)}else{h=false}});i.apply(this,k)}};var b=function(g){return Object.prototype.toString.call(g)==="[object String]"};var f=0;function c(h,i){this.$el=e(h);this.id="textcomplete"+f++;this.strategies=[];this.views=[];this.option=e.extend({},c._getDefaults(),i);if(!this.$el.is("input[type=text]")&&!this.$el.is("input[type=search]")&&!this.$el.is("textarea")&&!h.isContentEditable&&h.contentEditable!="true"){throw new Error("textcomplete must be called on a Textarea or a ContentEditable.")}if(h===h.ownerDocument.activeElement){this.initialize()}else{var g=this;this.$el.one("focus."+this.id,function(){g.initialize()});if((!this.option.adapter||this.option.adapter=="CKEditor")&&typeof CKEDITOR!="undefined"&&(this.$el.is("textarea"))){CKEDITOR.on("instanceReady",function(j){j.editor.once("focus",function(k){g.$el=e(j.editor.editable().$);if(!g.option.adapter){g.option.adapter=e.fn.textcomplete.CKEditor}g.initialize()})})}}}c._getDefaults=function(){if(!c.DEFAULTS){c.DEFAULTS={appendTo:e("body"),className:"",dropdownClassName:"dropdown-menu textcomplete-dropdown",maxCount:10,zIndex:"100"}}return c.DEFAULTS};e.extend(c.prototype,{id:null,option:null,strategies:null,adapter:null,dropdown:null,$el:null,$iframe:null,initialize:function(){var g=this.$el.get(0);if(this.$el.prop("ownerDocument")!==document&&window.frames.length){for(var i=0;i<window.frames.length;i++){if(this.$el.prop("ownerDocument")===window.frames[i].document){this.$iframe=e(window.frames[i].frameElement);break}}}this.dropdown=new e.fn.textcomplete.Dropdown(g,this,this.option);var j,h;if(this.option.adapter){j=this.option.adapter}else{if(this.$el.is("textarea")||this.$el.is("input[type=text]")||this.$el.is("input[type=search]")){h=typeof g.selectionEnd==="number"?"Textarea":"IETextarea"}else{h="ContentEditable"}j=e.fn.textcomplete[h]}this.adapter=new j(g,this,this.option)},destroy:function(){this.$el.off("."+this.id);if(this.adapter){this.adapter.destroy()}if(this.dropdown){this.dropdown.destroy()}this.$el=this.adapter=this.dropdown=null},deactivate:function(){if(this.dropdown){this.dropdown.deactivate()}},trigger:function(j,h){if(!this.dropdown){this.initialize()}j!=null||(j=this.adapter.getTextFromHeadToCaret());var i=this._extractSearchQuery(j);if(i.length){var g=i[1];if(h&&this._term===g&&g!==""){return}this._term=g;this._search.apply(this,i)}else{this._term=null;this.dropdown.deactivate()}},fire:function(g){var h=Array.prototype.slice.call(arguments,1);this.$el.trigger(g,h);return this},register:function(g){Array.prototype.push.apply(this.strategies,g)},select:function(g,i,h){this._term=null;this.adapter.select(g,i,h);this.fire("change").fire("textComplete:select",g,i);this.adapter.focus()},_clearAtNext:true,_term:null,_extractSearchQuery:function(m){for(var j=0;j<this.strategies.length;j++){var l=this.strategies[j];var h=l.context(m);if(h||h===""){var k=e.isFunction(l.match)?l.match(m):l.match;if(b(h)){m=h}var g=m.match(k);if(g){return[l,g[l.index],g]}}}return[]},_search:d(function(k,j,i,h){var g=this;j.search(i,function(m,l){if(!g.dropdown.shown){g.dropdown.activate()}if(g._clearAtNext){g.dropdown.clear();g._clearAtNext=false}g.dropdown.setPosition(g.adapter.getCaretPosition());g.dropdown.render(g._zip(m,j,i));if(!l){k();g._clearAtNext=true}},h)}),_zip:function(h,i,g){return e.map(h,function(j){return{value:j,strategy:i,term:g}})}});e.fn.textcomplete.Completer=c}(a);+function(f){var g=f(window);var d=function(l,h){var k,m;var j=h.strategy.idProperty;for(k=0;k<l.length;k++){m=l[k];if(m.strategy!==h.strategy){continue}if(j){if(m.value[j]===h.value[j]){return true}}else{if(m.value===h.value){return true}}}return false};var e={};f(document).on("click",function(h){var i=h.originalEvent&&h.originalEvent.keepTextCompleteDropdown;f.each(e,function(k,j){if(k!==i){j.deactivate()}})});var c={SKIP_DEFAULT:0,KEY_UP:1,KEY_DOWN:2,KEY_ENTER:3,KEY_PAGEUP:4,KEY_PAGEDOWN:5,KEY_ESCAPE:6};function b(j,i,k){this.$el=b.createElement(k);this.completer=i;this.id=i.id+"dropdown";this._data=[];this.$inputEl=f(j);this.option=k;if(k.listPosition){this.setPosition=k.listPosition}if(k.height){this.$el.height(k.height)}var h=this;f.each(["maxCount","placement","footer","header","noResultsMessage","className"],function(m,l){if(k[l]!=null){h[l]=k[l]}});this._bindEvents(j);e[this.id]=this}f.extend(b,{createElement:function(i){var j=i.appendTo;if(!(j instanceof f)){j=f(j)}var h=f("<ul></ul>").addClass(i.dropdownClassName).attr("id","textcomplete-dropdown-"+i._oid).css({display:"none",left:0,position:"absolute",zIndex:i.zIndex}).appendTo(j);return h}});f.extend(b.prototype,{$el:null,$inputEl:null,completer:null,footer:null,header:null,id:null,maxCount:null,placement:"",shown:false,data:[],className:"",destroy:function(){this.deactivate();this.$el.off("."+this.id);this.$inputEl.off("."+this.id);this.clear();this.$el.remove();this.$el=this.$inputEl=this.completer=null;delete e[this.id]},render:function(h){var k=this._buildContents(h);var i=f.map(this.data,function(l){return l.value});if(this.data.length){var j=h[0].strategy;if(j.id){this.$el.attr("data-strategy",j.id)}else{this.$el.removeAttr("data-strategy")}this._renderHeader(i);this._renderFooter(i);if(k){this._renderContents(k);this._fitToBottom();this._fitToRight();this._activateIndexedItem()}this._setScroll()}else{if(this.noResultsMessage){this._renderNoResultsMessage(i)}else{if(this.shown){this.deactivate()}}}},setPosition:function(i){var h="absolute";this.$inputEl.add(this.$inputEl.parents()).each(function(){if(f(this).css("position")==="absolute"){return false}if(f(this).css("position")==="fixed"){i.top-=g.scrollTop();i.left-=g.scrollLeft();h="fixed";return false}});this.$el.css(this._applyPlacement(i));this.$el.css({position:h});return this},clear:function(){this.$el.html("");this.data=[];this._index=0;this._$header=this._$footer=this._$noResultsMessage=null},activate:function(){if(!this.shown){this.clear();this.$el.show();if(this.className){this.$el.addClass(this.className)}this.completer.fire("textComplete:show");this.shown=true}return this},deactivate:function(){if(this.shown){this.$el.hide();if(this.className){this.$el.removeClass(this.className)}this.completer.fire("textComplete:hide");this.shown=false}return this},isUp:function(h){return h.keyCode===38||(h.ctrlKey&&h.keyCode===80)},isDown:function(h){return h.keyCode===40||(h.ctrlKey&&h.keyCode===78)},isEnter:function(i){var h=i.ctrlKey||i.altKey||i.metaKey||i.shiftKey;return !h&&(i.keyCode===13||i.keyCode===9||(this.option.completeOnSpace===true&&i.keyCode===32))},isPageup:function(h){return h.keyCode===33},isPagedown:function(h){return h.keyCode===34},isEscape:function(h){return h.keyCode===27},_data:null,_index:null,_$header:null,_$noResultsMessage:null,_$footer:null,_bindEvents:function(){this.$el.on("mousedown."+this.id,".textcomplete-item",f.proxy(this._onClick,this));this.$el.on("touchstart."+this.id,".textcomplete-item",f.proxy(this._onClick,this));this.$el.on("mouseover."+this.id,".textcomplete-item",f.proxy(this._onMouseover,this));this.$inputEl.on("keydown."+this.id,f.proxy(this._onKeydown,this))},_onClick:function(k){var j=f(k.target);k.preventDefault();k.originalEvent.keepTextCompleteDropdown=this.id;if(!j.hasClass("textcomplete-item")){j=j.closest(".textcomplete-item")}var i=this.data[parseInt(j.data("index"),10)];this.completer.select(i.value,i.strategy,k);var h=this;setTimeout(function(){h.deactivate();if(k.type==="touchstart"){h.$inputEl.focus()}},0)},_onMouseover:function(i){var h=f(i.target);i.preventDefault();if(!h.hasClass("textcomplete-item")){h=h.closest(".textcomplete-item")}this._index=parseInt(h.data("index"),10);this._activateIndexedItem()},_onKeydown:function(h){if(!this.shown){return}var i;if(f.isFunction(this.option.onKeydown)){i=this.option.onKeydown(h,c)}if(i==null){i=this._defaultKeydown(h)}switch(i){case c.KEY_UP:h.preventDefault();this._up();break;case c.KEY_DOWN:h.preventDefault();this._down();break;case c.KEY_ENTER:h.preventDefault();this._enter(h);break;case c.KEY_PAGEUP:h.preventDefault();this._pageup();break;case c.KEY_PAGEDOWN:h.preventDefault();this._pagedown();break;case c.KEY_ESCAPE:h.preventDefault();this.deactivate();break}},_defaultKeydown:function(h){if(this.isUp(h)){return c.KEY_UP}else{if(this.isDown(h)){return c.KEY_DOWN}else{if(this.isEnter(h)){return c.KEY_ENTER}else{if(this.isPageup(h)){return c.KEY_PAGEUP}else{if(this.isPagedown(h)){return c.KEY_PAGEDOWN}else{if(this.isEscape(h)){return c.KEY_ESCAPE}}}}}}},_up:function(){if(this._index===0){this._index=this.data.length-1}else{this._index-=1}this._activateIndexedItem();this._setScroll()},_down:function(){if(this._index===this.data.length-1){this._index=0}else{this._index+=1}this._activateIndexedItem();this._setScroll()},_enter:function(i){var h=this.data[parseInt(this._getActiveElement().data("index"),10)];this.completer.select(h.value,h.strategy,i);this.deactivate()},_pageup:function(){var i=0;var h=this._getActiveElement().position().top-this.$el.innerHeight();this.$el.children().each(function(j){if(f(this).position().top+f(this).outerHeight()>h){i=j;return false}});this._index=i;this._activateIndexedItem();this._setScroll()},_pagedown:function(){var i=this.data.length-1;var h=this._getActiveElement().position().top+this.$el.innerHeight();this.$el.children().each(function(j){if(f(this).position().top>h){i=j;return false}});this._index=i;this._activateIndexedItem();this._setScroll()},_activateIndexedItem:function(){this.$el.find(".textcomplete-item.active").removeClass("active");this._getActiveElement().addClass("active")},_getActiveElement:function(){return this.$el.children(".textcomplete-item:nth("+this._index+")")},_setScroll:function(){var k=this._getActiveElement();var j=k.position().top;var l=k.outerHeight();var h=this.$el.innerHeight();var i=this.$el.scrollTop();if(this._index===0||this._index==this.data.length-1||j<0){this.$el.scrollTop(j+i)}else{if(j+l>h){this.$el.scrollTop(j+l+i-h)}}},_buildContents:function(m){var h,l,j;var k="";for(l=0;l<m.length;l++){if(this.data.length===this.maxCount){break}h=m[l];if(d(this.data,h)){continue}j=this.data.length;this.data.push(h);k+='<li class="textcomplete-item" data-index="'+j+'"><a>';k+=h.strategy.template(h.value,h.term);k+="</a></li>"}return k},_renderHeader:function(i){if(this.header){if(!this._$header){this._$header=f('<li class="textcomplete-header"></li>').prependTo(this.$el)}var h=f.isFunction(this.header)?this.header(i):this.header;this._$header.html(h)}},_renderFooter:function(i){if(this.footer){if(!this._$footer){this._$footer=f('<li class="textcomplete-footer"></li>').appendTo(this.$el)}var h=f.isFunction(this.footer)?this.footer(i):this.footer;this._$footer.html(h)}},_renderNoResultsMessage:function(i){if(this.noResultsMessage){if(!this._$noResultsMessage){this._$noResultsMessage=f('<li class="textcomplete-no-results-message"></li>').appendTo(this.$el)}var h=f.isFunction(this.noResultsMessage)?this.noResultsMessage(i):this.noResultsMessage;this._$noResultsMessage.html(h)}},_renderContents:function(h){if(this._$footer){this._$footer.before(h)}else{this.$el.append(h)}},_fitToBottom:function(){var i=g.scrollTop()+g.height();var h=this.$el.height();if((this.$el.position().top+h)>i&&this.$el.css("position")!="fixed"){if(!this.completer.$iframe){this.$el.offset({top:i-h})}}},_fitToRight:function(){var h=30;var k=this.$el.offset().left,l;var j=this.$el.width();var i=g.width()-h;while(k+j>i){this.$el.offset({left:k-h});l=this.$el.offset().left;if(l>=k){break}k=l}},_applyPlacement:function(h){if(this.placement.indexOf("top")!==-1){h={top:"auto",bottom:this.$el.parent().height()-h.top+h.lineHeight,left:h.left}}else{h.bottom="auto";delete h.lineHeight}if(this.placement.indexOf("absleft")!==-1){h.left=0}else{if(this.placement.indexOf("absright")!==-1){h.right=0;h.left="auto"}}return h}});f.fn.textcomplete.Dropdown=b;f.extend(f.fn.textcomplete,c)}(a);+function(b){var d=function(f){var e={};return function(g,h){if(e[g]){h(e[g])}else{f.call(this,g,function(i){e[g]=(e[g]||[]).concat(i);h.apply(null,arguments)})}}};function c(e){b.extend(this,e);if(this.cache){this.search=d(this.search)}}c.parse=function(e,f){return b.map(e,function(h){var g=new c(h);g.el=f.el;g.$el=f.$el;return g})};b.extend(c.prototype,{match:null,replace:null,search:null,id:null,cache:false,context:function(){return true},index:2,template:function(e){return e},idProperty:null});b.fn.textcomplete.Strategy=c}(a);+function(d){var c=Date.now||function(){return new Date().getTime()};var b=function(j,m){var l,h,i,k,f;var g=function(){var n=c()-k;if(n<m){l=setTimeout(g,m-n)}else{l=null;f=j.apply(i,h);i=h=null}};return function(){i=this;h=arguments;k=c();if(!l){l=setTimeout(g,m)}return f}};function e(){}d.extend(e.prototype,{id:null,completer:null,el:null,$el:null,option:null,initialize:function(g,f,h){this.el=g;this.$el=d(g);this.id=f.id+this.constructor.name;this.completer=f;this.option=h;if(this.option.debounce){this._onKeyup=b(this._onKeyup,this.option.debounce)}this._bindEvents()},destroy:function(){this.$el.off("."+this.id);this.$el=this.el=this.completer=null},select:function(){throw new Error("Not implemented")},getCaretPosition:function(){var f=this._getCaretRelativePosition();var i=this.$el.offset();var h=this.option.appendTo;if(h){if(!(h instanceof d)){h=d(h)}var g=h.offsetParent().offset();i.top-=g.top;i.left-=g.left}f.top+=i.top;f.left+=i.left;return f},focus:function(){this.$el.focus()},_bindEvents:function(){this.$el.on("keyup."+this.id,d.proxy(this._onKeyup,this))},_onKeyup:function(f){if(this._skipSearch(f)){return}this.completer.trigger(this.getTextFromHeadToCaret(),true)},_skipSearch:function(f){switch(f.keyCode){case 9:case 13:case 40:case 38:case 27:return true}if(f.ctrlKey){switch(f.keyCode){case 78:case 80:return true}}}});d.fn.textcomplete.Adapter=e}(a);+function(c){function b(e,d,f){this.initialize(e,d,f)}c.extend(b.prototype,c.fn.textcomplete.Adapter.prototype,{select:function(g,k,j){var i=this.getTextFromHeadToCaret();var f=this.el.value.substring(this.el.selectionEnd);var h=k.replace(g,j);var d;if(typeof h!=="undefined"){if(c.isArray(h)){f=h[1]+f;h=h[0]}d=c.isFunction(k.match)?k.match(i):k.match;i=i.replace(d,h);this.$el.val(i+f);this.el.selectionStart=this.el.selectionEnd=i.length}},getTextFromHeadToCaret:function(){return this.el.value.substring(0,this.el.selectionEnd)},_getCaretRelativePosition:function(){var d=c.fn.textcomplete.getCaretCoordinates(this.el,this.el.selectionStart);return{top:d.top+this._calculateLineHeight()-this.$el.scrollTop(),left:d.left-this.$el.scrollLeft(),lineHeight:this._calculateLineHeight()}},_calculateLineHeight:function(){var g=parseInt(this.$el.css("line-height"),10);if(isNaN(g)){var d=this.el.parentNode;var e=document.createElement(this.el.nodeName);var f=this.el.style;e.setAttribute("style","margin:0px;padding:0px;font-family:"+f.fontFamily+";font-size:"+f.fontSize);e.innerHTML="test";d.appendChild(e);g=e.clientHeight;d.removeChild(e)}return g}});c.fn.textcomplete.Textarea=b}(a);+function(d){var b="吶";function c(f,e,g){this.initialize(f,e,g);d("<span>"+b+"</span>").css({position:"absolute",top:-9999,left:-9999}).insertBefore(f)}d.extend(c.prototype,d.fn.textcomplete.Textarea.prototype,{select:function(i,m,l){var k=this.getTextFromHeadToCaret();var h=this.el.value.substring(k.length);var j=m.replace(i,l);var g;if(typeof j!=="undefined"){if(d.isArray(j)){h=j[1]+h;j=j[0]}g=d.isFunction(m.match)?m.match(k):m.match;k=k.replace(g,j);this.$el.val(k+h);this.el.focus();var f=this.el.createTextRange();f.collapse(true);f.moveEnd("character",k.length);f.moveStart("character",k.length);f.select()}},getTextFromHeadToCaret:function(){this.el.focus();var f=document.selection.createRange();f.moveStart("character",-this.el.value.length);var e=f.text.split(b);return e.length===1?e[0]:e[1]}});d.fn.textcomplete.IETextarea=c}(a);+function(c){function b(e,d,f){this.initialize(e,d,f)}c.extend(b.prototype,c.fn.textcomplete.Adapter.prototype,{select:function(q,k,n){var i=this.getTextFromHeadToCaret();var h=this.el.ownerDocument.getSelection();var l=h.getRangeAt(0);var r=l.cloneRange();r.selectNodeContents(l.startContainer);var o=r.toString();var t=o.substring(l.startOffset);var j=k.replace(q,n);var p;if(typeof j!=="undefined"){if(c.isArray(j)){t=j[1]+t;j=j[0]}p=c.isFunction(k.match)?k.match(i):k.match;i=i.replace(p,j).replace(/ $/,"&nbsp");l.selectNodeContents(l.startContainer);l.deleteContents();var g=this.el.ownerDocument.createElement("div");g.innerHTML=i;var s=this.el.ownerDocument.createElement("div");s.innerHTML=t;var m=this.el.ownerDocument.createDocumentFragment();var f;var d;while(f=g.firstChild){d=m.appendChild(f)}while(f=s.firstChild){m.appendChild(f)}l.insertNode(m);l.setStartAfter(d);l.collapse(true);h.removeAllRanges();h.addRange(l)}},_getCaretRelativePosition:function(){var f=this.el.ownerDocument.getSelection().getRangeAt(0).cloneRange();var g=this.el.ownerDocument.createElement("span");f.insertNode(g);f.selectNodeContents(g);f.deleteContents();var e=c(g);var d=e.offset();d.left-=this.$el.offset().left;d.top+=e.height()-this.$el.offset().top;d.lineHeight=e.height();if(this.completer.$iframe){var h=this.completer.$iframe.offset();d.top+=h.top;d.left+=h.left;d.top-=this.$el.scrollTop()}e.remove();return d},getTextFromHeadToCaret:function(){var d=this.el.ownerDocument.getSelection().getRangeAt(0);var e=d.cloneRange();e.selectNodeContents(d.startContainer);return e.toString().substring(0,d.startOffset)}});c.fn.textcomplete.ContentEditable=b}(a);+function(c){function b(e,d,f){this.initialize(e,d,f)}c.extend(b.prototype,c.fn.textcomplete.ContentEditable.prototype,{_bindEvents:function(){var d=this;CKEDITOR.instances.issue_notes.on("key",function(f){var e=f.data;d._onKeyup(e);if(d.completer.dropdown.shown&&d._skipSearch(e)){return false}},null,null,1);this.$el.on("keyup."+this.id,c.proxy(this._onKeyup,this))}});c.fn.textcomplete.CKEditor=b}(a);(function(e){var c=["direction","boxSizing","width","height","overflowX","overflowY","borderTopWidth","borderRightWidth","borderBottomWidth","borderLeftWidth","borderStyle","paddingTop","paddingRight","paddingBottom","paddingLeft","fontStyle","fontVariant","fontWeight","fontStretch","fontSize","fontSizeAdjust","lineHeight","fontFamily","textAlign","textTransform","textIndent","textDecoration","letterSpacing","wordSpacing","tabSize","MozTabSize"];var d=(typeof window!=="undefined");var f=(d&&window.mozInnerScreenX!=null);function b(l,m,p){if(!d){throw new Error("textarea-caret-position#getCaretCoordinates should only be called in a browser")}var i=p&&p.debug||false;if(i){var j=document.querySelector("#input-textarea-caret-position-mirror-div");if(j){j.parentNode.removeChild(j)}}var g=document.createElement("div");g.id="input-textarea-caret-position-mirror-div";document.body.appendChild(g);var h=g.style;var k=window.getComputedStyle?getComputedStyle(l):l.currentStyle;h.whiteSpace="pre-wrap";if(l.nodeName!=="INPUT"){h.wordWrap="break-word"}h.position="absolute";if(!i){h.visibility="hidden"}c.forEach(function(q){h[q]=k[q]});if(f){if(l.scrollHeight>parseInt(k.height)){h.overflowY="scroll"}}else{h.overflow="hidden"}g.textContent=l.value.substring(0,m);if(l.nodeName==="INPUT"){g.textContent=g.textContent.replace(/\s/g,"\u00a0")}var o=document.createElement("span");o.textContent=l.value.substring(m)||".";g.appendChild(o);var n={top:o.offsetTop+parseInt(k.borderTopWidth),left:o.offsetLeft+parseInt(k.borderLeftWidth)};if(i){o.style.backgroundColor="#aaa"}else{document.body.removeChild(g)}return n}e.fn.textcomplete.getCaretCoordinates=b}(a));return a}));